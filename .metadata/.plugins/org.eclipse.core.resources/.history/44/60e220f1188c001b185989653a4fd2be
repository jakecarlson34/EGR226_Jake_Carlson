/**************************************************************************************
 * Author: Jake Carlson
 * Course: EGR 226 - 902
 * Date: 03/17/2021
 * Project: lab09part2
 * File: part2main.c
 * Description: This program controls the speed of a DC motor using Timer A and 3
 * buttons.
 *
 **************************************************************************************/


#include "msp.h"
#include <stdio.h>
#include <stdlib.h>

void SysTick_init();
void SysTick_Delay(uint16_t delayms);
void LED(int);
void sysflag();
volatile int i;
volatile int b;

/**

 g 4.0
 f 4.1
 a 4.2
 b 4.3
 e 4.4
 d 4.5
 c 4.6
 dp 4.7
 */


void main(void)
{
	WDT_A->CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;		// stop watchdog timer

	SysTick_init();
	    __enable_irq();

	P4->SEL1 &= ~(BIT0|BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);
	P4->SEL0 &= ~(BIT0|BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);
	P4->DIR |= (BIT0|BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);



	b = 9;
	i = 0;

	while(1){
	   if(b==1){

	       if(i<9){
	           i++;
	       }
	       else if(i == 9){
	           i = 0;
	       }
	       b = 0;
	   }
	   LED(i);
	}

}
void sysflag(){
    b = 1;
}
void SysTick_init(){//SysTick Initialization from previous labs
    SysTick->CTRL = 0;
    SysTick->LOAD = 0x00FFFFFF;
    SysTick->VAL = 0;
    SysTick->CTRL = 0x00000005;
}

void SysTick_Delay(uint16_t delayms){//delay function from previous labs
    SysTick->LOAD = ((delayms *3000)-1);
    SysTick->VAL = 0;
    while((SysTick->CTRL & 0x00010000)==0);

}

void LED(int count){
    int c = count;

    switch(c){
    case 0:
        P4->OUT |= (BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);
        break;

    case 1:
        P4->OUT |=(BIT3|BIT6);
        break;

    case 2:
        P4->OUT |= (BIT0|BIT2|BIT3|BIT4|BIT5);
        break;

    case 3:
        P4->OUT |= (BIT0|BIT2|BIT3|BIT5|BIT6);
        break;

    case 4:
        P4->OUT |= (BIT0|BIT1|BIT3|BIT6);
        break;

    case 5:
        P4->OUT |= (BIT0|BIT1|BIT2|BIT5|BIT6);
        break;

    case 6:
        P4->OUT |= (BIT0|BIT1|BIT2|BIT4|BIT5|BIT6);
        break;

    case 7:
        P4->OUT |= (BIT2|BIT3|BIT6);
        break;

    case 8:
        P4->OUT |= (BIT0|BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);
        break;

    case 9:
        P4->OUT |= (BIT0|BIT1|BIT2|BIT3|BIT5|BIT6);
        break;
    }
    P4->OUT &=~ (BIT0|BIT1|BIT2|BIT3|BIT4|BIT5|BIT6);
}
